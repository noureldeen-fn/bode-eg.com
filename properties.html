<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>BODE | The Art of Portraying The Future</title>
    <meta
      name="description"
      content="BODE Real Estate Investment - Building trust and crafting legacies. We master the art of portraying the future through strategic and luxury real estate developments."
    />

    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon.png" />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="images/favicon2.jpg"
    />
    <link rel="apple-touch-icon" href="images/favicon2.jpg" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <link href="./output.css" rel="stylesheet" />
    <link rel="stylesheet" href="custom.css" />
  </head>
  <body class="bg-bode-ivory text-bode-midnight font-sans antialiased">
    <nav
      class="w-full px-6 md:px-10 py-4 flex justify-between items-center bg-bode-midnight shadow-lg fixed top-0 left-0 right-0 z-50"
    >
      <a href="index.html" class="block w-28 md:w-36">
        <img
          src="./images/off-white.png"
          alt="BODE Logo"
          class="w-full h-auto"
        />
      </a>

      <button
        id="hamburger"
        class="md:hidden p-2 focus:outline-none"
        style="z-index: 1001"
      >
        <svg
          width="32"
          height="32"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M7 6H20M4 12H20M7 18H20"
            stroke="#F0C689"
            stroke-width="2.5"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </button>

      <div
        class="hidden md:flex items-center space-x-8 font-sans font-bold text-base text-bode-ivory"
      >
        <a href="/" class="hover:text-bode-sunlit transition duration-300"
          >HOME</a
        >
        <a
          href="/properties"
          class="hover:text-bode-sunlit transition duration-300"
          >PROPERTIES</a
        >
        <a
          href="/contact"
          class="px-6 py-2 border-2 border-bode-sunlit text-bode-sunlit rounded-full hover:bg-bode-sunlit hover:text-bode-midnight transition duration-300 shadow-md"
        >
          CONTACT US
        </a>
      </div>

      <div
        id="mobileMenu"
        class="hidden absolute top-full left-0 w-full h-screen bg-bode-midnight border-t border-bode-sunlit/20 md:hidden transition-all duration-300 ease-in-out"
      >
        <div
          class="flex flex-col items-center pt-10 space-y-8 font-sans font-bold text-bode-ivory"
        >
          <a
            href="/"
            class="text-xl hover:text-bode-sunlit transition w-full text-center py-4 border-b border-bode-sunlit/10"
            >HOME</a
          >
          <a
            href="/properties"
            class="text-xl hover:text-bode-sunlit transition w-full text-center py-4 border-b border-bode-sunlit/10"
            >PROPERTIES</a
          >
          <a
            href="/contact"
            class="mt-6 px-10 py-3 border-2 border-bode-sunlit text-bode-sunlit rounded-full hover:bg-bode-sunlit hover:text-bode-midnight transition duration-300 shadow-lg text-lg"
          >
            CONTACT US
          </a>
        </div>
      </div>
    </nav>

    <div class="h-32"></div>

    <header class="container mx-auto px-6 py-12 text-center">
      <h1 class="text-4xl md:text-5xl font-black mb-4">
        <span
          class="bg-clip-text text-transparent bg-gradient-to-r from-bode-crimson to-bode-midnight font-bold"
        >
          OUR
        </span>
        PROJECTS
      </h1>
      <p class="text-gray-600 max-w-2xl mx-auto">
        We plan for your future investment depending on our experience.
      </p>
    </header>

    <section class="container mx-auto px-6 pb-20">
      <div id="properties-container" class="grid md:grid-cols-3 gap-10">
        <p class="text-center col-span-3 text-gray-500 animate-pulse">
          Loading Properties...
        </p>
      </div>
    </section>

    <script>
      // ============================================
      // 1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØµÙ…ÙŠÙ… (CSS Ø°ÙƒÙŠ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ ÙˆØ§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±)
      // ============================================
      const style = document.createElement("style");
      style.innerHTML = `
    .arrow-btn { transition: opacity 0.3s ease-in-out; }
    
    /* Ù„Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±: Ø§Ù„Ø£Ø³Ù‡Ù… Ù…Ø®ØªÙÙŠØ© ÙˆØªØ¸Ù‡Ø± Ù„Ù…Ø§ ØªÙ‚Ù Ø¨Ø§Ù„Ù…Ø§ÙˆØ³ */
    @media (min-width: 768px) {
      .arrow-btn { opacity: 0; }
      .property-card:hover .arrow-btn { opacity: 1; }
    }

    /* Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„: Ø§Ù„Ø£Ø³Ù‡Ù… Ø¸Ø§Ù‡Ø±Ø© Ø¹Ù„Ø·ÙˆÙ„ (Ø¹Ø´Ø§Ù† Ù…ÙÙŠØ´ hover) */
    @media (max-width: 767px) {
      .arrow-btn { opacity: 1; }
    }
  `;
      document.head.appendChild(style);

      // ============================================
      // 2. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Sanity
      // ============================================
      const PROJECT_ID = "bq3lz493";
      const DATASET = "production";
      const QUERY = encodeURIComponent(
        '*[_type == "property"]{title, location, price, description, "mainImage": mainImage.asset->url, "gallery": gallery[].asset->url}',
      );
      const URL = `https://${PROJECT_ID}.api.sanity.io/v2021-10-21/data/query/${DATASET}?query=${QUERY}`;

      // Ù…ØªØºÙŠØ±Ø§Øª Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø­Ø¨ (Swipe)
      window.slidersData = {};
      let touchStartX = 0;
      let touchEndX = 0;

      async function fetchProperties() {
        const container = document.getElementById("properties-container");
        try {
          const response = await fetch(URL);
          const data = await response.json();
          const properties = data.result;

          container.innerHTML = "";

          if (properties.length === 0) {
            container.innerHTML =
              '<p class="text-center col-span-3">No properties found.</p>';
            return;
          }

          properties.forEach((prop, index) => {
            const galleryImages = prop.gallery || [];
            const allImages = [prop.mainImage, ...galleryImages].filter(
              Boolean,
            );

            if (allImages.length === 0)
              allImages.push("https://via.placeholder.com/800x600");

            const cardId = `card-${index}`;
            window.slidersData[cardId] = { images: allImages, current: 0 };

            let formattedPrice = prop.price
              ? prop.price.toLocaleString() + " EGP"
              : "Call for Price";
            let shortDesc = prop.description
              ? prop.description.substring(0, 100) + "..."
              : "";

            // =======================================================
            // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
            // =======================================================
            let controlsHTML = "";
            if (allImages.length > 1) {
              controlsHTML = `
                <button onclick="changeSlide('${cardId}', -1)" 
                    class="arrow-btn"
                    style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); z-index: 9999; background-color: rgba(0,0,0,0.6); color: white; width: 35px; height: 35px; border-radius: 50%; border: none; cursor: pointer; font-size: 18px; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(2px);">
                    â®
                </button>
                
                <button onclick="changeSlide('${cardId}', 1)" 
                    class="arrow-btn"
                    style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); z-index: 9999; background-color: rgba(0,0,0,0.6); color: white; width: 35px; height: 35px; border-radius: 50%; border: none; cursor: pointer; font-size: 18px; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(2px);">
                    â¯
                </button>
                
                <div style="position: absolute; bottom: 15px; left: 50%; transform: translateX(-50%); z-index: 9999; display: flex; gap: 5px;">
                    ${allImages
                      .map(
                        (_, i) =>
                          `<span id="${cardId}-dot-${i}" style="width: 8px; height: 8px; border-radius: 50%; background-color: ${i === 0 ? "white" : "rgba(255,255,255,0.5)"}; display: block; cursor: pointer; box-shadow: 0 1px 3px rgba(0,0,0,0.3);" onclick="goToSlide('${cardId}', ${i})"></span>`,
                      )
                      .join("")}
                </div>
            `;
            }

            // =======================================================
            // Ø§Ù„ÙƒØ§Ø±Øª (Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø³Ø§Øª Ø§Ù„Ù„Ù…Ø³ ontouchstart Ùˆ ontouchend)
            // =======================================================
            const cardHTML = `
        <div class="group property-card bg-white rounded-[20px] overflow-hidden shadow-lg hover:shadow-2xl transition duration-300 border border-gray-100 flex flex-col h-full relative" id="${cardId}">
          
          <div class="relative h-64 shrink-0" style="position: relative;"
               ontouchstart="recordTouchStart(event)" 
               ontouchend="detectSwipe(event, '${cardId}')">
               
            <img 
              id="${cardId}-img"
              src="${allImages[0]}" 
              alt="${prop.title}" 
              class="w-full h-full object-cover transform group-hover:scale-110 transition duration-700 ease-in-out relative z-10"
              style="pointer-events: none;" 
            />
            <div class="absolute top-4 right-4 bg-bode-crimson text-white text-xs font-bold px-3 py-1 rounded-full uppercase z-40 shadow-md">
              For Sale
            </div>

            ${controlsHTML}
          </div>

          <div class="p-6 flex flex-col flex-grow relative z-30 bg-white">
            <h3 class="text-xl font-bold mb-2 text-bode-midnight">${prop.title}</h3>
            <p class="text-bode-sunlit font-semibold text-sm mb-2">ğŸ“ ${prop.location}</p>
            <p class="text-gray-500 text-sm mb-4 line-clamp-2">${shortDesc}</p>
            
            <div class="flex justify-between items-center border-t border-gray-100 pt-4 mt-auto">
              <span class="text-bode-midnight font-black text-lg">${formattedPrice}</span>
              <a href="contact.html" class="text-bode-crimson font-bold text-sm hover:underline">Buy Now &rarr;</a>
            </div>
          </div>
        </div>
        `;

            container.innerHTML += cardHTML;
          });
        } catch (error) {
          console.error(error);
        }
      }

      // ============================================
      // 3. Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ§Ù„Ù„Ù…Ø³ (Swipe Logic)
      // ============================================

      // ØªØ³Ø¬ÙŠÙ„ Ù†Ù‚Ø·Ø© Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù„Ù…Ø³
      window.recordTouchStart = function (e) {
        touchStartX = e.changedTouches[0].screenX;
      };

      // ØªØ³Ø¬ÙŠÙ„ Ù†Ù‚Ø·Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ© ÙˆØªÙ†ÙÙŠØ° Ø§Ù„Ø­Ø±ÙƒØ©
      window.detectSwipe = function (e, cardId) {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipeGesture(cardId);
      };

      function handleSwipeGesture(cardId) {
        // Ù„Ùˆ Ø§Ù„Ø³Ø­Ø¨Ø© ÙƒØ§Ù†Øª Ù‚ÙˆÙŠØ© ÙƒÙØ§ÙŠØ© (Ø£ÙƒØªØ± Ù…Ù† 50 Ø¨ÙŠÙƒØ³Ù„)
        if (touchEndX < touchStartX - 50) {
          changeSlide(cardId, 1); // Ø³Ø­Ø¨ Ù„Ù„Ø´Ù…Ø§Ù„ -> Ø§Ù„ØªØ§Ù„ÙŠ
        }
        if (touchEndX > touchStartX + 50) {
          changeSlide(cardId, -1); // Ø³Ø­Ø¨ Ù„Ù„ÙŠÙ…ÙŠÙ† -> Ø§Ù„Ø³Ø§Ø¨Ù‚
        }
      }

      window.changeSlide = function (cardId, direction) {
        if (event) {
          event.preventDefault();
          event.stopPropagation();
        }
        const data = window.slidersData[cardId];
        if (!data) return;

        let newIndex = data.current + direction;
        if (newIndex >= data.images.length) newIndex = 0;
        if (newIndex < 0) newIndex = data.images.length - 1;

        updateUI(cardId, newIndex);
      };

      window.goToSlide = function (cardId, index) {
        if (event) {
          event.preventDefault();
          event.stopPropagation();
        }
        updateUI(cardId, index);
      };

      function updateUI(cardId, index) {
        const data = window.slidersData[cardId];
        data.current = index;

        const img = document.getElementById(`${cardId}-img`);
        if (img) img.src = data.images[index];

        data.images.forEach((_, i) => {
          const dot = document.getElementById(`${cardId}-dot-${i}`);
          if (dot)
            dot.style.backgroundColor =
              i === index ? "white" : "rgba(255,255,255,0.5)";
        });
      }

      fetchProperties();
    </script>

    <footer
      class="bg-bode-midnight text-white pt-14 pb-6 border-t border-gray-800"
    >
      <div class="container mx-auto px-6">
        <div class="grid md:grid-cols-3 gap-10 mb-8">
          <div class="space-y-4">
            <img
              src="./images/off-white.png"
              alt="BODE Logo"
              class="w-32 mb-4"
            />
            <p class="text-gray-400 text-sm leading-relaxed max-w-xs">
              The Art of Portraying the Future. We are dedicated to crafting
              strategic environments for a prosperous tomorrow.
            </p>
          </div>

          <div>
            <h3
              class="text-bode-sunlit font-bold uppercase tracking-widest mb-4 text-lg"
            >
              Quick Links
            </h3>
            <ul class="space-y-2 text-sm text-gray-300">
              <li>
                <a href="/" class="hover:text-white transition">Home</a>
              </li>
              <li>
                <a href="/properties" class="hover:text-white transition"
                  >Properties</a
                >
              </li>
              <li>
                <a href="index.html#about" class="hover:text-white transition">
                  Our Vision
                </a>
              </li>
              <li>
                <a href="/contact" class="hover:text-white transition"
                  >Contact Us</a
                >
              </li>
            </ul>
          </div>

          <div>
            <h3
              class="text-bode-sunlit font-bold uppercase tracking-widest mb-4 text-lg"
            >
              Get in Touch
            </h3>
            <div class="space-y-4 text-sm text-gray-300">
              <div class="flex items-start space-x-3">
                <span class="opacity-50">ğŸ“</span>
                <span class="leading-tight"
                  >TOP 90 MALL, 90TH STREET NORTH,<br />OFFICE 323, 3RD
                  FLOOR,<br />Cairo, Egypt</span
                >
              </div>

              <div class="flex items-center space-x-3">
                <span class="opacity-50">âœ‰ï¸</span>
                <a
                  href="https://mail.google.com/mail/u/0/?fs=1&to=bodeforrealestateinvestment@gmail.com&tf=cm"
                  target="_blank"
                  class="hover:text-white transition"
                  >bodeforrealestateinvestment@gmail.com</a
                >
              </div>

              <div class="flex items-center space-x-3">
                <span class="opacity-50">ğŸ“</span>
                <a
                  href="tel:+201117365999"
                  class="text-white text-base hover:text-bode-sunlit transition"
                  dir="ltr"
                >
                  +20 11 17365999
                </a>
              </div>
            </div>
          </div>
        </div>

        <div class="border-t border-gray-800 my-6"></div>

        <div
          class="flex flex-col md:flex-row justify-between items-center text-xs text-gray-500"
        >
          <p>&copy; 2026 BODE Realty. All rights reserved.</p>
        </div>
      </div>
    </footer>
    <script src="script.js"></script>
  </body>
</html>
